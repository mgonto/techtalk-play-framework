<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd">

    <bean name="dsSimon" class="org.springframework.jndi.JndiObjectFactoryBean">
       <property name="resourceRef" value="true" />
       <property name="jndiName" value="jdbc/dsSimon"/>
       <property name="defaultObject">
           <bean  class="com.gire.girelib.db.datasource.ActivaRolesDataSource"
               destroy-method="close">
            <property name="driverClassName" value="${dsSimon.driverClassName}" />
            <property name="url" value="${dsSimon.url}" />
            <property name="username" value="${dsSimon.username}" />
            <property name="password" value="${dsSimon.password}" />

            <property name="nombreSistema" value="SIFON_PREGENERADOR"/>
            <property name="executeActivaRoles" value="${dsSimon.executeActivaRoles}"/>
        </bean>
       </property>
   </bean>
</beans>
<ehcache>
    <diskStore path="java.io.tmpdir"/>

    <defaultCache
        maxElementsInMemory="300"
        eternal="false"
        timeToIdleSeconds="64800"
        timeToLiveSeconds="64800"
        overflowToDisk="false"  />

</ehcache>
<?xml version="1.0" encoding="ISO-8859-1"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
       http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd">

    <!-- Hibernate Properties -->
    <bean id="hibernatePropertiesSimon" 
     class="org.springframework.beans.factory.config.PropertiesFactoryBean">
     <property name="properties">
      <props>
        <prop key="hibernate.hbm2ddl.auto">${simon.hibernate.hbm2ddl.auto}</prop>
        <prop key="hibernate.dialect">${simon.hibernate.dialect}</prop>
        <prop key="hibernate.show_sql">${simon.hibernate.show_sql}</prop>
        <prop key="hibernate.cache.use_second_level_cache">true</prop>
        <prop key="hibernate.cache.region_prefix"></prop>
        <prop key="hibernate.cache.region.factory_class">net.sf.ehcache.hibernate.EhCacheRegionFactory</prop>
         <prop key="net.sf.ehcache.configurationResourceName">/com/gire/simon/model/impl/config/persistance/ehcache.xml</prop>
         <prop key="hibernate.default_schema">${simon.hibernate.default_schema}</prop>
         <prop key="hibernate.cache.use_query_cache">false</prop>
         <prop key="hibernate.generate_statistics">true</prop>
      </props>
     </property>
    </bean>
    
    <!-- Hibernate Properties -->
    <bean id="hibernateInterceptor" class="ar.com.zauber.commons.repository.utils.SpringInjectionHibernateAuditLoggerInterceptor">
        <constructor-arg>
            <bean class="ar.com.zauber.commons.repository.utils.SpringInjectionInterceptor">
                <constructor-arg ref="annotatedClassesSimon"/>
            </bean>
        </constructor-arg>
        <property name="authenticationUserMapper" ref="userMapper"/>       
    </bean>
    
    <bean id="userMapper" class="ar.com.zauber.commons.repository.utils.AnonymousAuthenticationUserMapper">
             <constructor-arg index="0" value="anonymous"/>
        </bean>
            
  <bean id="hibernateTemplateSimon" 
    class="org.springframework.orm.hibernate3.HibernateTemplate">
    <property name="sessionFactory" ref="sessionFactorySimon"/>
    <property name="flushMode" value="1"/>
  </bean>
  
  
  <bean id="transactionManagerSimon"
    class="org.springframework.orm.hibernate3.HibernateTransactionManager">
    <property name="sessionFactory" ref="sessionFactorySimon"/>
  </bean>
  
     <tx:annotation-driven transaction-manager="transactionManagerSimon"/>
</beans>
<?xml version="1.0" encoding="ISO-8859-1"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd">
       
  <bean id="annotatedClassesSimon" class="java.util.LinkedList">
    <constructor-arg>
      <list>
         <value>com.gire.simon.model.impl.config.SimpleCompania</value>
         <value>com.gire.simon.model.impl.config.SimpleEndpoint</value>
         <value>com.gire.simon.model.impl.config.SimpleServicio</value>
         <value>com.gire.simon.model.impl.config.SimpleTipoServicio</value>
         <value>com.gire.simon.model.impl.config.SimpleTipoServicioParam</value>
          <value>com.gire.simon.model.impl.config.SimpleEsmeMessage</value>
          <value>com.gire.simon.model.impl.config.SimpleBulkConfiguracion</value>
          <value>com.gire.simon.model.impl.config.SimpleArchivoProcesado</value>
          <value>com.gire.simon.model.impl.config.SimpleSimonLog</value>
          <value>com.gire.simon.model.impl.config.sto.SimpleOperador</value>
          <value>com.gire.simon.model.impl.config.SimpleBlackList</value>
      </list>
    </constructor-arg>
  </bean>
  
   
</beans>
<?xml version="1.0" encoding="ISO-8859-1"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
       http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd">

    <!-- Hibernate SessionFactory -->
    <bean id="sessionFactorySimon" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
        <property name="hibernateProperties" ref="hibernatePropertiesSimon"/>
        <!--  OR mapping files. -->
        <property name="annotatedClasses" ref="annotatedClassesSimon" />
        <property name="dataSource" ref="dsSimon" />
        <property name="entityInterceptor"  ref="hibernateInterceptor"/>
        <property name="lobHandler">
            <bean id="lobHandler" class="${hibernate.lobHandler}" />
        </property>
    </bean>
</beans>
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:util="http://www.springframework.org/schema/util"
    xsi:schemaLocation="
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd">
       
    <bean name="simonRepository" class="com.gire.simon.model.impl.config.HibernateSimonRepository">
        <constructor-arg index="0" ref="hibernateTemplateSimon"/>
        <constructor-arg index="1" value="${simon.repository.updateTime}"/>
    </bean>
    
    <bean name="esmeRepository" class="com.gire.simon.model.impl.config.HibernateEsmeRepository">
        <constructor-arg index="0" ref="hibernateTemplateSimon"/>
    </bean>
    
    
</beans>